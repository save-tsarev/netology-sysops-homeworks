# Домашнее задание к занятию «Управление пакетами»

### Цель задания

В результате выполнения этого задания вы закрепите свои знания об устройстве репозиториев, а также:
* научитесь устанавливать пакеты,
* научитесь собирать пакеты из исходников.

### Инструкция к заданию

1. Домашнее задание выполните в [Google Docs](https://docs.google.com/) и отправьте на проверку ссылку на ваш документ в личном кабинете.
2. В названии файла введите корректное название лекции и вашу фамилию и имя.
3. Зайдите в настройки доступа и выберите доступ «Просматривать могут все в интернете, у кого есть ссылка».
 Ссылка на инструкцию, [как предоставить доступ к файлам и папкам на Google Диске](https://support.google.com/docs/answer/2494822?hl=ru&co=GENIE.Platform%3DDesktop).
5. Скопируйте текст задания в свой документ.
6. Выполните домашнее задание, запишите ответы и приложите необходимые скриншоты в свой Google Документ.
7. Для проверки домашнего задания преподавателем отправьте ссылку на ваш документ в личном кабинете.
8. Любые вопросы по решению задач задавайте в чате учебной группы.


### Задание 1

Опишите достоинства и недостатки работы с пакетным менеджером и репозиторием.

*Напишите ответ в свободной форме.*


### Задание 2

Ответьте на вопросы:
* какие действия надо выполнить при подключении стороннего репозитория,
* в чём опасность такого способа распространения ПО и как это решить.

*Напишите ответ в свободной форме.*



### Задание 3

1. Запустите свою виртуальную машину.
2. Найдите в репозиториях и установите пакет `htop`.

Какие зависимости требует `htop`?

*Ответ приведите в виде текста команды, которой вы это выполнили, а также приложите скриншот места расположения исполняемых файлов установленного ПО.*


### Задание 4

1. Подключите репозиторий PHP и установите PHP 8.0.

*Приложите скриншот содержимого файла, в котором записан адрес репозитория.*

2. При помощи команды `php -v` убедитесь, что поставлена корректная версия PHP.

*Приложите к ответу скриншот версии.*


### Задание 5

Ваш коллега-программист просит вас установить модуль `google-api-python-client` на сервер, который необходим для программы, работающей с Google API.

Установите этот пакет при помощи менеджера пакетов `pip`.

**Примечение №1:** для установки может понадобиться пакет `python-distutils`, проверьте его наличие в системе.

**Примечение №2:** если возникнет ошибка при установке с помощью Python версии 2, воспользуйтесь командой `python3`.

*Приложите скриншоты  с установленным пакетом `python-distutils`, с версией `Pip` и установленными модулями, они должны быть видимы.*

---

**

## Дополнительные задания (со звёздочкой*)
Эти задания дополнительные и не обязательны к выполнению, они никак не повлияют на получение вами зачёта по этому домашнему заданию. Вы можете их выполнить, если хотите глубже разобраться в материале.

### Задание 6*

1. Перечислите менеджеры пакетов, кроме тех, о которых говорилось на лекции.
В каких дистрибутивах они работают?

2. Есть ли альтернативные менеджеры для тех, которые разбирались на лекции?

*Напишите ответ в свободной форме.*


### Задание 7*

1. Скачайте исходники Zabbix и соберите Zabbix Agent для того дистрибутива, на котором вы работаете.
2. Установите его при помощи менеджера пакетов.

*Ответ приведите в виде скриншота.*

### Задание 8*

1. Скачайте исходники Zabbix и соберите Zabbix Server для того дистрибутива, на котором вы работаете.
2. Установите его при помощи менеджера пакетов.

*Ответ приведите в виде скриншота.*

### Решение 8

# **Установка и настройка Zabbix Server с PostgreSQL на Ubuntu**

Эта инструкция поможет вам установить Zabbix Server с базой данных PostgreSQL на Ubuntu, используя сборку из исходников.

---

## **1. Установка необходимых зависимостей**
Перед установкой убедитесь, что все пакеты обновлены:
```bash
sudo apt update && sudo apt upgrade -y
```
Затем установите необходимые пакеты:
```bash

sudo apt install -y build-essential gcc make autoconf libc6-dev \
    postgresql postgresql-contrib libpq-dev \
    libldap2-dev libssl-dev pkg-config curl wget libsnmp-dev snmp \
    libevent-dev libpcre2-dev libxml2-dev dh-autoreconf
```


⸻

2. Установка и настройка PostgreSQL

Запустите и включите PostgreSQL:
```bash
sudo systemctl enable --now postgresql
```
Создайте базу данных и пользователя для Zabbix:
```bash
sudo -i -u postgres psql
```
Выполните в консоли PostgreSQL:
```bash
CREATE DATABASE zabbix OWNER zabbix;
CREATE USER zabbix WITH ENCRYPTED PASSWORD 'zabbix_password';
GRANT ALL PRIVILEGES ON DATABASE zabbix TO zabbix;
ALTER DATABASE zabbix SET timezone TO 'UTC';
\q
```


⸻

3. Скачивание исходников Zabbix

Перейдите в домашний каталог и скачайте исходники:
```bash
cd ~
wget https://cdn.zabbix.com/zabbix/sources/stable/7.0/zabbix-7.0.10.tar.gz
tar -xvzf zabbix-7.0.10.tar.gz
cd zabbix-7.0.10
```


⸻

4. Сборка Zabbix с поддержкой PostgreSQL
```bash
./configure --enable-server --enable-agent \
    --with-postgresql --with-net-snmp --with-libcurl \
    --with-openssl --with-ldap
make -j$(nproc)
sudo make install
```


⸻

5. Импорт схемы базы данных

Импортируйте начальные данные в PostgreSQL:
```bash
cd database/postgresql/
sudo -u postgres psql zabbix < schema.sql
sudo -u postgres psql zabbix < images.sql
sudo -u postgres psql zabbix < data.sql
```


⸻

6. Настройка конфигурационного файла Zabbix

Откройте файл конфигурации:
```bash
sudo nano /usr/local/etc/zabbix_server.conf
```
Измените параметры подключения к базе данных:
```bash
DBName=zabbix
DBUser=zabbix
DBPassword=zabbix_password
```
Сохраните изменения (Ctrl+X, затем Y и Enter).

⸻

7. Создание и запуск службы Zabbix Server

Создайте файл сервиса /etc/systemd/system/zabbix-server.service:
```bash
sudo nano /etc/systemd/system/zabbix-server.service
```
Добавьте содержимое:
```bash
[Unit]
Description=Zabbix Server
After=network.target postgresql.service

[Service]
Type=forking
ExecStart=/usr/local/sbin/zabbix_server
PIDFile=/run/zabbix/zabbix_server.pid
Restart=on-failure

[Install]
WantedBy=multi-user.target
```
Сохраните изменения и запустите службу:
```bash
sudo systemctl daemon-reload
sudo systemctl enable --now zabbix-server
```


⸻

8. Проверка работы Zabbix Server
```bash
sudo systemctl status zabbix-server
```
Если сервер работает, он должен быть в статусе active (running).

⸻

9. Настройка веб-интерфейса (опционально)

Установите веб-сервер и PHP:
```bash
sudo apt install -y apache2 php php-pgsql php-gd php-xml php-bcmath php-mbstring
```
Скопируйте файлы веб-интерфейса:
```bash
sudo cp -r ui /var/www/html/zabbix
sudo chown -R www-data:www-data /var/www/html/zabbix
```
Перезапустите Apache:
```bash
sudo systemctl restart apache2
```
Теперь интерфейс доступен по адресу http://<IP-сервера>/zabbix.

