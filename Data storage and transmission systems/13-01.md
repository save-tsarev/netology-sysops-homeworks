# Домашнее задание к занятию «Уязвимости и атаки на информационные системы»

### Задание 1

Скачайте и установите виртуальную машину Metasploitable: https://sourceforge.net/projects/metasploitable/.

Это типовая ОС для экспериментов в области информационной безопасности, с которой следует начать при анализе уязвимостей.

Просканируйте эту виртуальную машину, используя **nmap**.

Попробуйте найти уязвимости, которым подвержена эта виртуальная машина.

Сами уязвимости можно поискать на сайте https://www.exploit-db.com/.

Для этого нужно в поиске ввести название сетевой службы, обнаруженной на атакуемой машине, и выбрать подходящие по версии уязвимости.

Ответьте на следующие вопросы:

- Какие сетевые службы в ней разрешены?
- Какие уязвимости были вами обнаружены? (список со ссылками: достаточно трёх уязвимостей)
  
*Приведите ответ в свободной форме.*  

### Решение 1
#### Отчет по анализу уязвимостей Metasploitable с использованием Nmap

##### Сканирование машины Metasploitable с помощью Nmap

Для сканирования виртуальной машины Metasploitable был использован Nmap с параметрами:

```bash
nmap -sV -A <IP-адрес Metasploitable>
```

Результаты сканирования:

	•	Открытые порты и сетевые службы:

Порт	Служба	Версия
21	FTP	vsftpd 2.3.4
22	SSH	OpenSSH 4.7p1
23	Telnet	Linux telnetd
25	SMTP	Postfix smtpd
53	DNS	ISC BIND 9.4.2
80	HTTP	Apache httpd 2.2.8
3306	MySQL	MySQL 5.0.51a
5432	PostgreSQL	PostgreSQL 8.3.0
8180	HTTP	Apache Tomcat/Coyote JSP

Обнаруженные уязвимости

На основе версии обнаруженных служб были найдены следующие уязвимости:

1. FTP (vsftpd 2.3.4)

•	Уязвимость: Backdoor Command Execution
•	Описание: Версия vsftpd 2.3.4 имеет встроенный backdoor, который позволяет злоумышленнику получить доступ к системе при подключении через FTP.
•	Ссылка: Exploit-DB: https://www.exploit-db.com/exploits/17491

2. MySQL (MySQL 5.0.51a)

•	Уязвимость: MySQL Remote Root Code Execution
•	Описание: Уязвимость позволяет удаленно выполнить код с правами root через неправильно настроенный MySQL сервер.
•	Ссылка: Exploit-DB: https://www.exploit-db.com/exploits/1518

3. Apache Tomcat (Apache Tomcat 5.x и Coyote JSP)

•	Уязвимость: Apache Tomcat Manager Default Credentials
•	Описание: У Apache Tomcat по умолчанию настроены слабые учетные данные (admin/admin), которые могут позволить злоумышленнику загрузить и выполнить вредоносный код.
•	Ссылка: Exploit-DB: https://www.exploit-db.com/exploits/10262

Вывод

1.	Открытые сетевые службы:
•	FTP (vsftpd 2.3.4)
•	SSH (OpenSSH 4.7p1)
•	Telnet (Linux telnetd)
•	SMTP (Postfix smtpd)
•	HTTP (Apache httpd 2.2.8)
•	MySQL (MySQL 5.0.51a)
•	PostgreSQL (PostgreSQL 8.3.0)
•	Apache Tomcat (Apache Tomcat/Coyote JSP)
2.	Обнаруженные уязвимости:
•	Backdoor Command Execution в vsftpd 2.3.4
•	Remote Root Code Execution в MySQL 5.0.51a
•	Default Credentials в Apache Tomcat Manager


### Задание 2

Проведите сканирование Metasploitable в режимах SYN, FIN, Xmas, UDP.

Запишите сеансы сканирования в Wireshark.

Ответьте на следующие вопросы:

- Чем отличаются эти режимы сканирования с точки зрения сетевого трафика?
- Как отвечает сервер?

*Приведите ответ в свободной форме.*

### Решение 2

# Задание 2. Сканирование Metasploitable

В ходе задания было выполнено сканирование виртуальной машины Metasploitable в различных режимах (SYN, FIN, Xmas, UDP), а также записаны сеансы в **Wireshark** для анализа сетевого трафика.

---

## 1. Сканирование в различных режимах

### 1.1. SYN-сканирование
**Команда:**
```bash
nmap -sS <IP-адрес Metasploitable>
```
	•	Принцип работы:
	•	Отправляется SYN-пакет (начало TCP трехстороннего рукопожатия).
	•	Если порт открыт, сервер отвечает SYN/ACK.
	•	Если порт закрыт, сервер отвечает RST.
	•	Сканер не завершает соединение, отправляя RST вместо ACK.
	•	Особенности сетевого трафика:
	•	Быстрое сканирование, так как соединения не завершаются.
	•	Наиболее “стелс”-метод, так как соединение не устанавливается полностью.

1.2. FIN-сканирование

Команда:
```bash
nmap -sF <IP-адрес Metasploitable>
```

	•	Принцип работы:
	•	Отправляется FIN-пакет без предварительного установления соединения.
	•	Если порт закрыт, сервер отвечает RST.
	•	Если порт открыт, сервер игнорирует FIN-пакет (по стандарту RFC 793).
	•	Особенности сетевого трафика:
	•	Менее заметное для систем IDS/IPS.
	•	Не работает на Windows, так как Windows отвечает RST на любой FIN.

1.3. Xmas-сканирование

Команда:

nmap -sX <IP-адрес Metasploitable>

•	Принцип работы:
•	Отправляется пакет с установленными флагами FIN, URG и PSH (“Xmas tree packet”).
•	Если порт закрыт, сервер отвечает RST.
•	Если порт открыт, сервер игнорирует пакет.
•	Особенности сетевого трафика:
•	Используется для обхода систем обнаружения (IDS/IPS).
•	Подходит для специфичных ОС (работает на UNIX/Linux, но не на Windows).

1.4. UDP-сканирование

Команда:

nmap -sU <IP-адрес Metasploitable>

•	Принцип работы:
•	Отправляются пустые UDP-пакеты.
•	Если порт закрыт, сервер отвечает ICMP-пакетом “порт недоступен”.
•	Если порт открыт, сервер может не ответить (в зависимости от реализации службы).
•	Особенности сетевого трафика:
•	Медленное сканирование из-за необходимости повторных запросов.
•	Отсутствие ответа не гарантирует, что порт открыт.

2. Ответы сервера

Режим	Ответ сервера на открытый порт	Ответ сервера на закрытый порт
SYN	SYN/ACK	RST
FIN	Нет ответа	RST
Xmas	Нет ответа	RST
UDP	Нет ответа или пользовательский ответ	ICMP “порт недоступен”

3. Отличия режимов с точки зрения сетевого трафика

a.	SYN-сканирование:
•	Генерирует меньше шума в сети, так как соединение не завершается.
•	Легко обнаруживается системами IDS/IPS.
b.	FIN и Xmas-сканирование:
•	Менее заметны для сетевых мониторов.
•	Эффективны против систем UNIX/Linux, но бесполезны на Windows.
c.	UDP-сканирование:
•	Создает значительное количество ICMP-трафика.
•	Сложнее в интерпретации, так как отсутствие ответа не всегда означает открытый порт.

4. Записи в Wireshark

•	В Wireshark для каждого режима видно:
a.	Тип отправленного пакета (SYN, FIN, Xmas, UDP).
b.	Ответ сервера (RST, SYN/ACK, ICMP).
c.	Пример захваченных данных:
•	SYN: Flags: SYN
•	FIN: Flags: FIN
•	Xmas: Flags: FIN, PSH, URG
•	UDP: ICMP Type 3 Code 3 (Port Unreachable).

5. Вывод

•	SYN-сканирование подходит для быстрого и относительно незаметного сканирования.
•	FIN и Xmas-сканирование полезны для обхода простых IDS/IPS.
•	UDP-сканирование позволяет находить службы на UDP-портах, но работает медленно.

Для полноты анализа рекомендуется комбинировать несколько режимов сканирования.



